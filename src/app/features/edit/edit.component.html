<mat-card class="edit-card">
  <mat-card-title>Edit house</mat-card-title>

  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Name -->
    <mat-form-field class="full-width">
      <mat-label>Name</mat-label>
      <input matInput formControlName="name" required />
    </mat-form-field>

    <!-- State Autocomplete -->
    <mat-form-field class="full-width">
      <mat-label>State</mat-label>
      <input
        matInput
        [formControl]="stateControl"
        [matAutocomplete]="autoState"
      />
      <mat-autocomplete #autoState="matAutocomplete" autoActiveFirstOption>
        <mat-option *ngFor="let st of filteredStates | async" [value]="st.name">
          {{ st.name }}
        </mat-option>
        <mat-option
          *ngIf="stateControl.value && !(filteredStates | async)?.length"
          [value]="stateControl.value"
        >
          Add "{{ stateControl.value }}"
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- City Autocomplete -->
    <mat-form-field class="full-width">
      <mat-label>City</mat-label>
      <input
        matInput
        [formControl]="cityControl"
        [matAutocomplete]="autoCity"
      />
      <mat-autocomplete #autoCity="matAutocomplete" autoActiveFirstOption>
        <mat-option *ngFor="let city of filteredCities | async" [value]="city">
          {{ city }}
        </mat-option>
        <mat-option
          *ngIf="cityControl.value && !(filteredCities | async)?.length"
          [value]="cityControl.value"
        >
          Add "{{ cityControl.value }}"
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- Available Units -->
    <mat-form-field class="full-width">
      <mat-label>Available Units</mat-label>
      <input matInput type="number" formControlName="availableUnits" required />
      <mat-error
        *ngIf="
          form.get('availableUnits')?.invalid &&
          form.get('availableUnits')?.touched
        "
      >
        This field is required and must be greater than 0.
      </mat-error>
    </mat-form-field>

    <!-- Photo URL -->
    <mat-form-field class="full-width">
      <mat-label>Photo URL (optional)</mat-label>
      <input matInput formControlName="photo" />
    </mat-form-field>

    <!-- Wi-Fi Available -->
    <mat-checkbox formControlName="wifi"> Wi-Fi Available </mat-checkbox>

    <!-- Laundry Available -->
    <mat-checkbox formControlName="laundry"> Laundry Available </mat-checkbox>

    <!-- Image Preview & Upload -->
    <div *ngIf="imagePreview" class="image-preview">
      <img [src]="imagePreview" alt="Preview foto" />
    </div>

    <div class="edit-file-upload">
      <!-- classe atualizada -->
      <button mat-icon-button type="button" (click)="fileInput.click()">
        <mat-icon>upload</mat-icon>
      </button>
      <span>Select image</span>
      <input #fileInput type="file" hidden (change)="onImageSelected($event)" />
    </div>

    <!-- Actions -->
    <div class="actions" *ngIf="canEditOrDelete()">
      <button mat-raised-button color="warn" type="button" (click)="onDelete()">
        Delete
      </button>
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="form.invalid"
      >
        Save
      </button>
      <button mat-button type="button" (click)="onCancel()">Cancel</button>
    </div>
    <div class="actions" *ngIf="canEditOrDelete()">
      <!-- botÃµes de editar, deletar, etc -->
    </div>
  </form>
</mat-card>
